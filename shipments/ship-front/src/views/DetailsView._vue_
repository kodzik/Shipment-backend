<template>
  <div>
      {{currentShipment}}
    <form>
      <div class="form-group">
        <label for="title">Title</label>
        <input type="text" class="form-control" id="title"
          v-model="currentShipment.destination"/>
      </div>
    </form>

  <v-form >
    <v-container>
          <v-text-field
            v-model="currentShipment.shipment_id"
            :counter="10"
            label="Shipment ID"
            readonly
          ></v-text-field>

          <v-text-field
            :counter="10"
            label="Last name"
            required
          ></v-text-field>

          <v-text-field
            label="E-mail"
            required
          ></v-text-field>
    </v-container>
  </v-form>
  </div>
</template>

<script lang="ts">
import { defineComponent, toRaw } from "@vue/runtime-core";
import { shipmentsAPI } from "../API/shipments.api";
import Shipment from "../types/shipment";

export default defineComponent({
    name: "shipDetails",

    // NEEDS EDIT
    // setup(){
    //     const shipments = ref<Shipment[]>()
    //     const error = ref<string>()

    //     shipmentsAPI.getAllShipments().then( (response) => {
    //         [error.value, shipments.value] = response 
    //     })
    //     return { error, shipments }
    // },    

    data() {
        return {
            currentShipment: {} as Shipment,
            message: "",
        };
    },
    methods:{
        async getShipment(id: number){
            const [error, shipment] = await shipmentsAPI.getShipment(id)
            if(error) console.error(error);
            else this.currentShipment = await shipment;
            // console.log(this.currentShipment);
        },
        getShipment2(id: string){
            shipmentsAPI.test(id).then((response: any) => {
                this.currentShipment = toRaw(response.data[0]);
                console.log(this.currentShipment);
            })
        }
    },
    mounted() {
        this.message = "";
        this.getShipment2(this.$route.params.id);
    },
})
</script>

<style>

</style>